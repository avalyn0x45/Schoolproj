{
  "version": 3,
  "sources": ["../src/FitAddon.ts"],
  "sourcesContent": ["/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport type { Terminal, ITerminalAddon } from '@xterm/xterm';\nimport type { FitAddon as IFitApi } from '@xterm/addon-fit';\nimport { IRenderDimensions } from 'browser/renderer/shared/Types';\nimport { ViewportConstants } from 'browser/shared/Constants';\n\ninterface ITerminalDimensions {\n  /**\n   * The number of rows in the terminal.\n   */\n  rows: number;\n\n  /**\n   * The number of columns in the terminal.\n   */\n  cols: number;\n}\n\nconst MINIMUM_COLS = 2;\nconst MINIMUM_ROWS = 1;\n\nexport class FitAddon implements ITerminalAddon , IFitApi {\n  private _terminal: Terminal | undefined;\n\n  public activate(terminal: Terminal): void {\n    this._terminal = terminal;\n  }\n\n  public dispose(): void {}\n\n  public fit(): void {\n    const dims = this.proposeDimensions();\n    if (!dims || !this._terminal || isNaN(dims.cols) || isNaN(dims.rows)) {\n      return;\n    }\n\n    // TODO: Remove reliance on private API\n    const core = (this._terminal as any)._core;\n\n    // Force a full render\n    if (this._terminal.rows !== dims.rows || this._terminal.cols !== dims.cols) {\n      core._renderService.clear();\n      this._terminal.resize(dims.cols, dims.rows);\n    }\n  }\n\n  public proposeDimensions(): ITerminalDimensions | undefined {\n    if (!this._terminal) {\n      return undefined;\n    }\n\n    if (!this._terminal.element || !this._terminal.element.parentElement) {\n      return undefined;\n    }\n\n    // TODO: Remove reliance on private API\n    const core = (this._terminal as any)._core;\n    const dims: IRenderDimensions = core._renderService.dimensions;\n\n    if (dims.css.cell.width === 0 || dims.css.cell.height === 0) {\n      return undefined;\n    }\n\n    const scrollbarWidth = (this._terminal.options.scrollback === 0\n      ? 0\n      : (this._terminal.options.overviewRuler?.width || ViewportConstants.DEFAULT_SCROLL_BAR_WIDTH));\n\n    const parentElementStyle = window.getComputedStyle(this._terminal.element.parentElement);\n    const parentElementHeight = parseInt(parentElementStyle.getPropertyValue('height'));\n    const parentElementWidth = Math.max(0, parseInt(parentElementStyle.getPropertyValue('width')));\n    const elementStyle = window.getComputedStyle(this._terminal.element);\n    const elementPadding = {\n      top: parseInt(elementStyle.getPropertyValue('padding-top')),\n      bottom: parseInt(elementStyle.getPropertyValue('padding-bottom')),\n      right: parseInt(elementStyle.getPropertyValue('padding-right')),\n      left: parseInt(elementStyle.getPropertyValue('padding-left'))\n    };\n    const elementPaddingVer = elementPadding.top + elementPadding.bottom;\n    const elementPaddingHor = elementPadding.right + elementPadding.left;\n    const availableHeight = parentElementHeight - elementPaddingVer;\n    const availableWidth = parentElementWidth - elementPaddingHor - scrollbarWidth;\n    const geometry = {\n      cols: Math.max(MINIMUM_COLS, Math.floor(availableWidth / dims.css.cell.width)),\n      rows: Math.max(MINIMUM_ROWS, Math.floor(availableHeight / dims.css.cell.height))\n    };\n    return geometry;\n  }\n}\n"],
  "mappings": ";AAsBA,IAAM,eAAe;AACrB,IAAM,eAAe;AAEd,IAAM,WAAN,MAAmD;AAAA,EAGjD,SAAS,UAA0B;AACxC,SAAK,YAAY;AAAA,EACnB;AAAA,EAEO,UAAgB;AAAA,EAAC;AAAA,EAEjB,MAAY;AACjB,UAAM,OAAO,KAAK,kBAAkB;AACpC,QAAI,CAAC,QAAQ,CAAC,KAAK,aAAa,MAAM,KAAK,IAAI,KAAK,MAAM,KAAK,IAAI,GAAG;AACpE;AAAA,IACF;AAGA,UAAM,OAAQ,KAAK,UAAkB;AAGrC,QAAI,KAAK,UAAU,SAAS,KAAK,QAAQ,KAAK,UAAU,SAAS,KAAK,MAAM;AAC1E,WAAK,eAAe,MAAM;AAC1B,WAAK,UAAU,OAAO,KAAK,MAAM,KAAK,IAAI;AAAA,IAC5C;AAAA,EACF;AAAA,EAEO,oBAAqD;AAC1D,QAAI,CAAC,KAAK,WAAW;AACnB,aAAO;AAAA,IACT;AAEA,QAAI,CAAC,KAAK,UAAU,WAAW,CAAC,KAAK,UAAU,QAAQ,eAAe;AACpE,aAAO;AAAA,IACT;AAGA,UAAM,OAAQ,KAAK,UAAkB;AACrC,UAAM,OAA0B,KAAK,eAAe;AAEpD,QAAI,KAAK,IAAI,KAAK,UAAU,KAAK,KAAK,IAAI,KAAK,WAAW,GAAG;AAC3D,aAAO;AAAA,IACT;AAEA,UAAM,iBAAkB,KAAK,UAAU,QAAQ,eAAe,IAC1D,IACC,KAAK,UAAU,QAAQ,eAAe;AAE3C,UAAM,qBAAqB,OAAO,iBAAiB,KAAK,UAAU,QAAQ,aAAa;AACvF,UAAM,sBAAsB,SAAS,mBAAmB,iBAAiB,QAAQ,CAAC;AAClF,UAAM,qBAAqB,KAAK,IAAI,GAAG,SAAS,mBAAmB,iBAAiB,OAAO,CAAC,CAAC;AAC7F,UAAM,eAAe,OAAO,iBAAiB,KAAK,UAAU,OAAO;AACnE,UAAM,iBAAiB;AAAA,MACrB,KAAK,SAAS,aAAa,iBAAiB,aAAa,CAAC;AAAA,MAC1D,QAAQ,SAAS,aAAa,iBAAiB,gBAAgB,CAAC;AAAA,MAChE,OAAO,SAAS,aAAa,iBAAiB,eAAe,CAAC;AAAA,MAC9D,MAAM,SAAS,aAAa,iBAAiB,cAAc,CAAC;AAAA,IAC9D;AACA,UAAM,oBAAoB,eAAe,MAAM,eAAe;AAC9D,UAAM,oBAAoB,eAAe,QAAQ,eAAe;AAChE,UAAM,kBAAkB,sBAAsB;AAC9C,UAAM,iBAAiB,qBAAqB,oBAAoB;AAChE,UAAM,WAAW;AAAA,MACf,MAAM,KAAK,IAAI,cAAc,KAAK,MAAM,iBAAiB,KAAK,IAAI,KAAK,KAAK,CAAC;AAAA,MAC7E,MAAM,KAAK,IAAI,cAAc,KAAK,MAAM,kBAAkB,KAAK,IAAI,KAAK,MAAM,CAAC;AAAA,IACjF;AACA,WAAO;AAAA,EACT;AACF;",
  "names": []
}
